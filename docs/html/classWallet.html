<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Alvorada: Wallet Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Alvorada
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classWallet-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Wallet Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>HDWallet class, destined to handle the creation and storage of keys.  
 <a href="classWallet.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="wallet_8hpp_source.html">wallet.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0c15cb69b495714527f14af8bcf1c90a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classKey.html">Key</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWallet.html#a0c15cb69b495714527f14af8bcf1c90a">getKey</a> (unsigned int key_index=0)</td></tr>
<tr class="memdesc:a0c15cb69b495714527f14af8bcf1c90a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a <a class="el" href="classKey.html">Key</a> object created either from the seed or recovered from the disk <br  />
  <a href="classWallet.html#a0c15cb69b495714527f14af8bcf1c90a">More...</a><br /></td></tr>
<tr class="separator:a0c15cb69b495714527f14af8bcf1c90a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a85e763cd743bce960dbd344eabc49fc4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWallet.html#a85e763cd743bce960dbd344eabc49fc4">recoverPrivateKeyIndex</a> (unsigned int *key_index)</td></tr>
<tr class="memdesc:a85e763cd743bce960dbd344eabc49fc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tries to read 4 byte key index from the disk.  <a href="classWallet.html#a85e763cd743bce960dbd344eabc49fc4">More...</a><br /></td></tr>
<tr class="separator:a85e763cd743bce960dbd344eabc49fc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a707924fdfd72871734c26161495ae417"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWallet.html#a707924fdfd72871734c26161495ae417">receiveSeed</a> (byte **seed)</td></tr>
<tr class="memdesc:a707924fdfd72871734c26161495ae417"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tries to read the 64 bytes seed from the disk.  <a href="classWallet.html#a707924fdfd72871734c26161495ae417">More...</a><br /></td></tr>
<tr class="separator:a707924fdfd72871734c26161495ae417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab185ac11e2ed36dc125a710e841c2294"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWallet.html#ab185ac11e2ed36dc125a710e841c2294">generateSeed</a> (byte **seed)</td></tr>
<tr class="memdesc:ab185ac11e2ed36dc125a710e841c2294"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a 64 bytes seed from a pseudo-random cryptographic safe entropy source provided by the system.  <a href="classWallet.html#ab185ac11e2ed36dc125a710e841c2294">More...</a><br /></td></tr>
<tr class="separator:ab185ac11e2ed36dc125a710e841c2294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8060b5c0ed71d3e13b3d8cb32514685a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWallet.html#a8060b5c0ed71d3e13b3d8cb32514685a">generatePublicKey</a> (BIGNUM *private_key, EC_POINT **public_key)</td></tr>
<tr class="memdesc:a8060b5c0ed71d3e13b3d8cb32514685a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates the public key(33 bytes in the compressed form) from an existing private key.  <a href="classWallet.html#a8060b5c0ed71d3e13b3d8cb32514685a">More...</a><br /></td></tr>
<tr class="separator:a8060b5c0ed71d3e13b3d8cb32514685a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2f968663a789f5ec63712f9643e8017"><td class="memItemLeft" align="right" valign="top"><a id="aa2f968663a789f5ec63712f9643e8017"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWallet.html#aa2f968663a789f5ec63712f9643e8017">uint2uchar32</a> (byte *retorno, unsigned int)</td></tr>
<tr class="memdesc:aa2f968663a789f5ec63712f9643e8017"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts an uint to the equivalent bytes of unsigned char data. <br /></td></tr>
<tr class="separator:aa2f968663a789f5ec63712f9643e8017"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a424f85a46220e4c58a3162047192c420"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWallet.html#a424f85a46220e4c58a3162047192c420">initializeGenerators</a> ()</td></tr>
<tr class="memdesc:a424f85a46220e4c58a3162047192c420"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the genetors(private, public key and chaincode) with direct data from the hashed seed.  <a href="classWallet.html#a424f85a46220e4c58a3162047192c420">More...</a><br /></td></tr>
<tr class="separator:a424f85a46220e4c58a3162047192c420"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66d757f76ad5e5b48787d1e3132fd7d1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWallet.html#a66d757f76ad5e5b48787d1e3132fd7d1">generatePrivateKey</a> (BIGNUM **destination, unsigned int key_index)</td></tr>
<tr class="memdesc:a66d757f76ad5e5b48787d1e3132fd7d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new private key.  <a href="classWallet.html#a66d757f76ad5e5b48787d1e3132fd7d1">More...</a><br /></td></tr>
<tr class="separator:a66d757f76ad5e5b48787d1e3132fd7d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a905f01c98dfb239935ec141f382dcc07"><td class="memItemLeft" align="right" valign="top"><a id="a905f01c98dfb239935ec141f382dcc07"></a>
BIGNUM *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWallet.html#a905f01c98dfb239935ec141f382dcc07">generator_private_key</a></td></tr>
<tr class="memdesc:a905f01c98dfb239935ec141f382dcc07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initial Private key derived from the Seed. <br /></td></tr>
<tr class="separator:a905f01c98dfb239935ec141f382dcc07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ea66546e217667569ea13e008675cbc"><td class="memItemLeft" align="right" valign="top"><a id="a1ea66546e217667569ea13e008675cbc"></a>
EC_POINT *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWallet.html#a1ea66546e217667569ea13e008675cbc">generator_public_key</a></td></tr>
<tr class="memdesc:a1ea66546e217667569ea13e008675cbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initial Public key derived from the Seed. <br /></td></tr>
<tr class="separator:a1ea66546e217667569ea13e008675cbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a496e67a71c7a34267a9b32963465d6"><td class="memItemLeft" align="right" valign="top"><a id="a8a496e67a71c7a34267a9b32963465d6"></a>
BIGNUM *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWallet.html#a8a496e67a71c7a34267a9b32963465d6">generator_chaincode</a></td></tr>
<tr class="memdesc:a8a496e67a71c7a34267a9b32963465d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initial Public key derived from the Seed. <br /></td></tr>
<tr class="separator:a8a496e67a71c7a34267a9b32963465d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0643febd781d019b9c2242d62442ca80"><td class="memItemLeft" align="right" valign="top"><a id="a0643febd781d019b9c2242d62442ca80"></a>
BN_CTX *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWallet.html#a0643febd781d019b9c2242d62442ca80">context</a></td></tr>
<tr class="memdesc:a0643febd781d019b9c2242d62442ca80"><td class="mdescLeft">&#160;</td><td class="mdescRight">BIGNUM context to hold temporary variables useful for the lib. <br /></td></tr>
<tr class="separator:a0643febd781d019b9c2242d62442ca80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a673649772ce79f3baeb6ee503fec00e4"><td class="memItemLeft" align="right" valign="top"><a id="a673649772ce79f3baeb6ee503fec00e4"></a>
EC_GROUP *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWallet.html#a673649772ce79f3baeb6ee503fec00e4">curve</a></td></tr>
<tr class="memdesc:a673649772ce79f3baeb6ee503fec00e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Curve used in the EC multiplication. <br /></td></tr>
<tr class="separator:a673649772ce79f3baeb6ee503fec00e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>HDWallet class, destined to handle the creation and storage of keys. </p>
<p>The <a class="el" href="classWallet.html" title="HDWallet class, destined to handle the creation and storage of keys.">Wallet</a> class implements a HDWallet according to Bitcoin implementation model. A cryptographic secure random number and a salt are used for the deterministic creation of milions of child private and public keys. For more information about this specific type of wallet, refer to the Bitcoin Documentation or O'Reily's "Mastering Bitcoin" book. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a66d757f76ad5e5b48787d1e3132fd7d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66d757f76ad5e5b48787d1e3132fd7d1">&#9670;&nbsp;</a></span>generatePrivateKey()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Wallet::generatePrivateKey </td>
          <td>(</td>
          <td class="paramtype">BIGNUM **&#160;</td>
          <td class="paramname"><em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>key_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a new private key. </p>
<p>This function generates a new private key. The specific key is created based on the generators(that must be already initialized) and the key index, where 0 is the first possible key for that generator set, 1 is the second and so on. The first argument is a pointer for a non-initialized BIGNUM recipient and the second is the key index. The key index used as argument is stored for further recovery. </p>

</div>
</div>
<a id="a8060b5c0ed71d3e13b3d8cb32514685a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8060b5c0ed71d3e13b3d8cb32514685a">&#9670;&nbsp;</a></span>generatePublicKey()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Wallet::generatePublicKey </td>
          <td>(</td>
          <td class="paramtype">BIGNUM *&#160;</td>
          <td class="paramname"><em>private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">EC_POINT **&#160;</td>
          <td class="paramname"><em>public_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generates the public key(33 bytes in the compressed form) from an existing private key. </p>
<p>The first argument is a pointer to a initialized existing private_key and the second is a pointer to a non-initialized EC_POINT where the public_key is supposed to be stored. The function executes an EC multiplication in order to create a public key from an already created private key. In te same way that Bitcoin does, the signature algorithm uses the secp256k1 curve. </p>

</div>
</div>
<a id="ab185ac11e2ed36dc125a710e841c2294"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab185ac11e2ed36dc125a710e841c2294">&#9670;&nbsp;</a></span>generateSeed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Wallet::generateSeed </td>
          <td>(</td>
          <td class="paramtype">byte **&#160;</td>
          <td class="paramname"><em>seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a 64 bytes seed from a pseudo-random cryptographic safe entropy source provided by the system. </p>
<p>This function uses the /dev/urandom linux/unix file to obtain pseudo-random data generated by the O.S. </p>

</div>
</div>
<a id="a0c15cb69b495714527f14af8bcf1c90a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c15cb69b495714527f14af8bcf1c90a">&#9670;&nbsp;</a></span>getKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classKey.html">Key</a> * Wallet::getKey </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>key_index</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a <a class="el" href="classKey.html">Key</a> object created either from the seed or recovered from the disk <br  />
 </p>
<p>This function is the gateway of the wallet for obtaining keys, the only argument is the key index itself. When the key index value is set to zero(default value) the wallet will try to recover a pre-existing key and if no stored key is found, the wallet returns the first key for that generator set. Again, if no generator set is available( there is no stored seed), the wallet will create one and return the first key for that set. When the key index is greater than zero, the respective key is returned for that set(if no stored seed is found it is created). </p><dl class="section return"><dt>Returns</dt><dd>Returns a <a class="el" href="classKey.html">Key</a> object pointer or nullptr if some process fail </dd></dl>

</div>
</div>
<a id="a424f85a46220e4c58a3162047192c420"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a424f85a46220e4c58a3162047192c420">&#9670;&nbsp;</a></span>initializeGenerators()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Wallet::initializeGenerators </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize the genetors(private, public key and chaincode) with direct data from the hashed seed. </p>
<p>This function initialize the generators. The generators are the first data level for the creation of child keys in the HDwallet model: master private key, master public key and chaincode. All these variables are initialized from a random seed, provided by other functions in this class. The seed is hashed(SHA512) and the first half of the resulting data is used for the master private key, while the second half is assigned as the master chaincode. the master public key is naturally obtained from the respective private key. </p>

</div>
</div>
<a id="a707924fdfd72871734c26161495ae417"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a707924fdfd72871734c26161495ae417">&#9670;&nbsp;</a></span>receiveSeed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Wallet::receiveSeed </td>
          <td>(</td>
          <td class="paramtype">byte **&#160;</td>
          <td class="paramname"><em>seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tries to read the 64 bytes seed from the disk. </p>
<p>This function seeks the disk for a previously stored 32 bytes seed, if none is found the generateSeed function is called and the resulting seed is stored on the disk. </p>

</div>
</div>
<a id="a85e763cd743bce960dbd344eabc49fc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85e763cd743bce960dbd344eabc49fc4">&#9670;&nbsp;</a></span>recoverPrivateKeyIndex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Wallet::recoverPrivateKeyIndex </td>
          <td>(</td>
          <td class="paramtype">unsigned int *&#160;</td>
          <td class="paramname"><em>key_index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tries to read 4 byte key index from the disk. </p>
<p>This function seeks the disk for a previously stored 4 bytes key index. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/wilton/alvorada/include/<a class="el" href="wallet_8hpp_source.html">wallet.hpp</a></li>
<li>/home/wilton/alvorada/src/wallet.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
